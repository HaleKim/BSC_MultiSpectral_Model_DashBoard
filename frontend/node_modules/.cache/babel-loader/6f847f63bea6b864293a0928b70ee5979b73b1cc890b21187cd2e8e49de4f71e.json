{"ast":null,"code":"var _jsxFileName = \"D:\\\\Project2\\\\DashBoard\\\\ver_2\\\\frontend\\\\src\\\\components\\\\EventLog.js\",\n  _s = $RefreshSig$();\n// /frontend/src/components/EventLog.js (개선된 최종본)\n\nimport React, { useState, useEffect } from 'react';\nimport { getEvents } from '../services/api';\nimport { subscribeToEvent, unsubscribeFromEvent } from '../services/socket';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst EventLog = () => {\n  _s();\n  const [events, setEvents] = useState([]);\n  const videoBaseUrl = `${process.env.REACT_APP_API_URL}/event_recordings`;\n  useEffect(() => {\n    const fetchEvents = async () => {\n      try {\n        const {\n          data\n        } = await getEvents();\n        if (Array.isArray(data)) {\n          setEvents(data);\n        }\n      } catch (error) {\n        console.error(\"이벤트 로그를 가져오는 데 실패했습니다:\", error);\n      }\n    };\n    fetchEvents();\n    subscribeToEvent('new_event', newEvent => {\n      setEvents(prevEvents => [newEvent, ...prevEvents]);\n    });\n    return () => {\n      unsubscribeFromEvent('new_event');\n    };\n  }, []);\n\n  // 새로고침 함수 추가\n  const handleRefresh = async () => {\n    try {\n      const {\n        data\n      } = await getEvents();\n      if (Array.isArray(data)) {\n        setEvents(data);\n      }\n    } catch (error) {\n      console.error(\"이벤트 로그 새로고침 실패:\", error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"p-4 bg-gray-800 rounded-lg shadow-lg h-full flex flex-col\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-between items-center mb-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-lg font-semibold text-white\",\n        children: \"\\uC2E4\\uC2DC\\uAC04 \\uC774\\uBCA4\\uD2B8 \\uB85C\\uADF8\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleRefresh,\n        className: \"px-3 py-1 text-sm bg-gray-600 hover:bg-gray-700 rounded-lg transition-colors\",\n        children: \"\\uC0C8\\uB85C\\uACE0\\uCE68\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-3 overflow-y-auto flex-grow\",\n      children: events.length > 0 ? events.map(event => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-3 bg-gray-700 rounded-md flex items-start space-x-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-grow\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"font-bold text-red-400 capitalize\",\n            children: [event.detected_object || 'Event', \" (\\uC2E0\\uB8B0\\uB3C4: \", event.confidence, \"%)\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 65,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-sm text-gray-300\",\n            children: [event.camera_name, \" (\", event.location, \")\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 68,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"text-xs text-gray-400 mt-1\",\n            children: new Date(event.timestamp).toLocaleString()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 71,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 29\n        }, this), event.video_path_rgb && /*#__PURE__*/_jsxDEV(\"a\", {\n          href: `${videoBaseUrl}/${event.video_path_rgb}`,\n          target: \"_blank\",\n          rel: \"noopener noreferrer\",\n          className: \"px-3 py-1 text-sm bg-cyan-600 hover:bg-cyan-700 rounded-lg transition-colors self-center\",\n          children: \"\\uC601\\uC0C1\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 33\n        }, this)]\n      }, event.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 25\n      }, this)) : /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-gray-500 text-center pt-4\",\n        children: \"\\uD45C\\uC2DC\\uD560 \\uC774\\uBCA4\\uD2B8\\uAC00 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 47,\n    columnNumber: 9\n  }, this);\n};\n_s(EventLog, \"j18ueuia/psAZ/XawE3UyqzOWsE=\");\n_c = EventLog;\nexport default EventLog;\nvar _c;\n$RefreshReg$(_c, \"EventLog\");","map":{"version":3,"names":["React","useState","useEffect","getEvents","subscribeToEvent","unsubscribeFromEvent","jsxDEV","_jsxDEV","EventLog","_s","events","setEvents","videoBaseUrl","process","env","REACT_APP_API_URL","fetchEvents","data","Array","isArray","error","console","newEvent","prevEvents","handleRefresh","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","length","map","event","detected_object","confidence","camera_name","location","Date","timestamp","toLocaleString","video_path_rgb","href","target","rel","id","_c","$RefreshReg$"],"sources":["D:/Project2/DashBoard/ver_2/frontend/src/components/EventLog.js"],"sourcesContent":["// /frontend/src/components/EventLog.js (개선된 최종본)\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { getEvents } from '../services/api';\r\nimport { subscribeToEvent, unsubscribeFromEvent } from '../services/socket';\r\n\r\nconst EventLog = () => {\r\n    const [events, setEvents] = useState([]);\r\n    const videoBaseUrl = `${process.env.REACT_APP_API_URL}/event_recordings`;\r\n\r\n    useEffect(() => {\r\n        const fetchEvents = async () => {\r\n            try {\r\n                const { data } = await getEvents();\r\n                if (Array.isArray(data)) {\r\n                    setEvents(data);\r\n                }\r\n            } catch (error) {\r\n                console.error(\"이벤트 로그를 가져오는 데 실패했습니다:\", error);\r\n            }\r\n        };\r\n        fetchEvents();\r\n        \r\n        subscribeToEvent('new_event', (newEvent) => {\r\n            setEvents(prevEvents => [newEvent, ...prevEvents]);\r\n        });\r\n\r\n        return () => {\r\n            unsubscribeFromEvent('new_event');\r\n        }\r\n    }, []);\r\n\r\n    // 새로고침 함수 추가\r\n    const handleRefresh = async () => {\r\n        try {\r\n            const { data } = await getEvents();\r\n            if (Array.isArray(data)) {\r\n                setEvents(data);\r\n            }\r\n        } catch (error) {\r\n            console.error(\"이벤트 로그 새로고침 실패:\", error);\r\n        }\r\n    };\r\n\r\n\r\n    return (\r\n        <div className=\"p-4 bg-gray-800 rounded-lg shadow-lg h-full flex flex-col\">\r\n            <div className=\"flex justify-between items-center mb-2\">\r\n                <h3 className=\"text-lg font-semibold text-white\">실시간 이벤트 로그</h3>\r\n                <button \r\n                    onClick={handleRefresh}\r\n                    className=\"px-3 py-1 text-sm bg-gray-600 hover:bg-gray-700 rounded-lg transition-colors\"\r\n                >\r\n                    새로고침\r\n                </button>\r\n            </div>\r\n            <div className=\"space-y-3 overflow-y-auto flex-grow\">\r\n                {events.length > 0 ? (\r\n                    events.map((event) => (\r\n                        <div key={event.id} className=\"p-3 bg-gray-700 rounded-md flex items-start space-x-3\">\r\n                            {/* 썸네일 이미지 (있을 경우) */}\r\n                            {/* <img src={`${videoBaseUrl}/${event.thumbnail_path}`} alt=\"thumbnail\" className=\"w-16 h-16 object-cover rounded-md bg-black\"/> */}\r\n                            \r\n                            <div className=\"flex-grow\">\r\n                                <p className=\"font-bold text-red-400 capitalize\">\r\n                                    {event.detected_object || 'Event'} (신뢰도: {event.confidence}%)\r\n                                </p>\r\n                                <p className=\"text-sm text-gray-300\">\r\n                                    {event.camera_name} ({event.location})\r\n                                </p>\r\n                                <p className=\"text-xs text-gray-400 mt-1\">\r\n                                    {new Date(event.timestamp).toLocaleString()}\r\n                                </p>\r\n                            </div>\r\n\r\n                            {/* 영상 재생 버튼 */}\r\n                            {event.video_path_rgb && (\r\n                                <a \r\n                                    href={`${videoBaseUrl}/${event.video_path_rgb}`}\r\n                                    target=\"_blank\"\r\n                                    rel=\"noopener noreferrer\"\r\n                                    className=\"px-3 py-1 text-sm bg-cyan-600 hover:bg-cyan-700 rounded-lg transition-colors self-center\"\r\n                                >\r\n                                    영상\r\n                                </a>\r\n                            )}\r\n                        </div>\r\n                    ))\r\n                ) : (\r\n                    <p className=\"text-gray-500 text-center pt-4\">표시할 이벤트가 없습니다.</p>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default EventLog;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}